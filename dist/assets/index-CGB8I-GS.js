(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))i(h);new MutationObserver(h=>{for(const v of h)if(v.type==="childList")for(const C of v.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&i(C)}).observe(document,{childList:!0,subtree:!0});function r(h){const v={};return h.integrity&&(v.integrity=h.integrity),h.referrerPolicy&&(v.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?v.credentials="include":h.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function i(h){if(h.ep)return;h.ep=!0;const v=r(h);fetch(h.href,v)}})();const ce=[{question:"H√†nh ƒë·ªông n√†o l√† 'b∆°i'?",correct:"swim",wrong:"run",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'tr∆∞·ª£t bƒÉng'?",correct:"skate",wrong:"jump",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'tr∆∞·ª£t v√°n'?",correct:"skateboard",wrong:"walk",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'th·∫£ di·ªÅu'?",correct:"fly a kite",wrong:"catch a ball",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'v·∫Ω'?",correct:"draw",wrong:"write",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'ƒë·∫°p xe'?",correct:"ride a bike",wrong:"drive a car",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'tung h·ª©ng'?",correct:"juggle",wrong:"throw",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'h√°t'?",correct:"sing",wrong:"dance",category:"actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'c·ªüi gi√†y'?",correct:"take off my shoes",wrong:"put on my shoes",category:"action-sequences"},{question:"H√†nh ƒë·ªông n√†o l√† 'ƒëi gi√†y tr∆∞·ª£t'?",correct:"put on my skates",wrong:"take off my skates",category:"action-sequences"},{question:"H√†nh ƒë·ªông n√†o l√† 'l√™n v√°n tr∆∞·ª£t'?",correct:"get on my skateboard",wrong:"get off my skateboard",category:"action-sequences"},{question:"H√†nh ƒë·ªông n√†o l√† 'xu·ªëng xe ƒë·∫°p'?",correct:"get off my bike",wrong:"get on my bike",category:"action-sequences"},{question:"H√†nh ƒë·ªông n√†o l√† 'nh·∫£y v√†o h·ªì b∆°i'?",correct:"jump in the pool",wrong:"jump out of the pool",category:"action-sequences"},{question:"H√†nh ƒë·ªông n√†o l√† 'ƒë·∫°p ch√¢n'?",correct:"kick my feet",wrong:"clap my hands",category:"action-sequences"},{question:"Con v·∫≠t n√†o l√† 'con c√°'?",correct:"fish",wrong:"bird",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con th·ªè'?",correct:"rabbit",wrong:"cat",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con r√πa'?",correct:"turtle",wrong:"frog",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con ch√≥'?",correct:"dog",wrong:"cat",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con m√®o'?",correct:"cat",wrong:"dog",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con r·∫Øn'?",correct:"snake",wrong:"worm",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'chu·ªôt hamster'?",correct:"hamster",wrong:"mouse",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con chim'?",correct:"bird",wrong:"butterfly",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con v·ªãt'?",correct:"duck",wrong:"chicken",category:"animals"},{question:"Con v·∫≠t n√†o l√† 'con g·∫•u tr√∫c'?",correct:"panda",wrong:"bear",category:"animals"},{question:"H√†nh ƒë·ªông n√†o l√† 'nh·∫•c chu·ªôt hamster l√™n'?",correct:"pick up the hamster",wrong:"put down the hamster",category:"animal-actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'ƒë·∫∑t chu·ªôt hamster xu·ªëng'?",correct:"put down the hamster",wrong:"pick up the hamster",category:"animal-actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'cho c√° ƒÉn'?",correct:"feed the fish",wrong:"catch the fish",category:"animal-actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'vu·ªët ve con th·ªè'?",correct:"pet the rabbit",wrong:"chase the rabbit",category:"animal-actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'ch·∫£i l√¥ng con m√®o'?",correct:"brush the cat",wrong:"feed the cat",category:"animal-actions"},{question:"H√†nh ƒë·ªông n√†o l√† 'd·∫Øt ch√≥ ƒëi d·∫°o'?",correct:"walk the dog",wrong:"run with the dog",category:"animal-actions"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'ƒë·ªìng h·ªì'?",correct:"clock",wrong:"watch",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'b·∫£ng'?",correct:"board",wrong:"table",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'c·ª≠a'?",correct:"door",wrong:"window",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'b√†n h·ªçc'?",correct:"desk",wrong:"chair",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'm√°y nghe ƒëƒ©a CD'?",correct:"CD player",wrong:"radio",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'th√πng r√°c'?",correct:"trash can",wrong:"box",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'm√°y t√≠nh'?",correct:"computer",wrong:"TV",category:"classroom-objects"},{question:"ƒê·ªì v·∫≠t n√†o l√† 'gh·∫ø'?",correct:"chair",wrong:"desk",category:"classroom-objects"},{question:"C√¢u l·ªánh n√†o l√† 'ƒëi l√™n b·∫£ng'?",correct:"go to the board",wrong:"go to the door",category:"classroom-commands"},{question:"C√¢u l·ªánh n√†o l√† 'quay v·ªÅ ch·ªó ng·ªìi'?",correct:"go back to your seat",wrong:"stand up",category:"classroom-commands"},{question:"C√¢u l·ªánh n√†o l√† 'b·∫≠t m√°y t√≠nh'?",correct:"turn on the computer",wrong:"turn off the computer",category:"classroom-commands"},{question:"C√¢u l·ªánh n√†o l√† 'tƒÉng √¢m l∆∞·ª£ng m√°y t√≠nh'?",correct:"turn up the computer",wrong:"turn down the computer",category:"classroom-commands"},{question:"C√¢u l·ªánh n√†o l√† 'vi·∫øt t√™n c·ªßa con'?",correct:"write your name",wrong:"say your name",category:"classroom-commands"},{question:"C√¢u l·ªánh n√†o l√† 'v·ª©t r√°c'?",correct:"throw away the trash",wrong:"pick up the trash",category:"classroom-commands"}],K="vocabulary-game-questions";function R(){const o=localStorage.getItem(K);return o?JSON.parse(o):[...ce]}function Y(o){localStorage.setItem(K,JSON.stringify(o))}function Ve(o){const n=R();return n.push({...o,id:Date.now()}),Y(n),n}function We(o,n){const r=R();return o>=0&&o<r.length&&(r[o]={...r[o],...n},Y(r)),r}function $e(o){const n=R();return o>=0&&o<n.length&&(n.splice(o,1),Y(n)),n}function Ue(){return localStorage.removeItem(K),[...ce]}function ze(o=10){const r=[...R()].sort(()=>Math.random()-.5);return r.slice(0,Math.min(o,r.length))}function Ge(o){const n=Math.random()<.5;return{text:o.question,leftAnswer:n?o.correct:o.wrong,rightAnswer:n?o.wrong:o.correct,correctSide:n?"left":"right",category:o.category}}const _e={actions:"Actions","action-sequences":"Action Sequences",animals:"Animals","animal-actions":"Animal Actions","classroom-objects":"Classroom Objects","classroom-commands":"Classroom Commands"};let S=null,D=null,Q=!1,H=null,L=null;const ie=12,Ze=800;async function le(o,n){if(D){try{D.stop()}catch(r){console.warn("Error stopping camera:",r)}D=null}if(S){try{S.close()}catch(r){console.warn("Error closing FaceMesh:",r)}S=null}return Q=!1,J(),new Promise((r,i)=>{const h=window.FaceMesh;if(!h){console.error("FaceMesh not loaded from CDN"),i(new Error("FaceMesh not loaded"));return}S=new h({locateFile:C=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${C}`}),S.setOptions({maxNumFaces:1,refineLandmarks:!1,minDetectionConfidence:.5,minTrackingConfidence:.5}),S.onResults(C=>{Ke(C,n)});const v=window.Camera;if(!v){console.error("Camera utils not loaded from CDN"),i(new Error("Camera utils not loaded"));return}D=new v(o,{onFrame:async()=>{if(Q&&S)try{await S.send({image:o})}catch(C){console.error("FaceMesh send error:",C)}},width:640,height:480}),D.start().then(()=>{Q=!0,console.log("Camera started successfully, tracking enabled"),r()}).catch(C=>{console.error("Camera start failed:",C),i(C)})})}function Ke(o,n){const r=n==null?void 0:n.getContext("2d");if(r&&n.width>0&&r.clearRect(0,0,n.width,n.height),!o.multiFaceLandmarks||o.multiFaceLandmarks.length===0){se("No face detected",null);return}const i=o.multiFaceLandmarks[0],h=i[33],v=i[263],C=v.x-h.x,O=v.y-h.y,x=Math.atan2(O,C)*(180/Math.PI);let q=null;x<-ie?q="right":x>ie&&(q="left"),se(x,q),q&&H&&(L||(console.log(`Tilt detected: ${q}, angle: ${x.toFixed(1)}¬∞`),H(q),L=setTimeout(()=>{L=null},Ze))),r&&n&&n.width>0&&Ye(r,i,n,q)}function Ye(o,n,r,i){const h=r.width,v=r.height,C=n[1],O=(1-C.x)*h,x=C.y*v;if(o.beginPath(),o.arc(O,x,30,0,2*Math.PI),i==="left"||i==="right"?(o.strokeStyle="#4CAF50",o.lineWidth=4):(o.strokeStyle="#6C63FF",o.lineWidth=2),o.stroke(),i){o.font="40px Arial",o.fillStyle="#4CAF50",o.textAlign="center";const q=i==="left"?"‚¨ÖÔ∏è":"‚û°Ô∏è";o.fillText(q,O,x-50)}}function se(o,n){const r=document.getElementById("tilt-indicator"),i=document.getElementById("direction-arrow");r&&(typeof o=="string"?(r.textContent=o,r.className="tilt-indicator"):n==="left"?(r.textContent=`‚¨ÖÔ∏è Tilting LEFT (${Math.abs(o).toFixed(0)}¬∞)`,r.className="tilt-indicator left"):n==="right"?(r.textContent=`‚û°Ô∏è Tilting RIGHT (${Math.abs(o).toFixed(0)}¬∞)`,r.className="tilt-indicator right"):(r.textContent=`Keep your head straight (${Math.abs(o).toFixed(0)}¬∞)`,r.className="tilt-indicator")),i&&(i.className="direction-arrow",n==="left"?i.classList.add("show-left"):n==="right"&&i.classList.add("show-right"))}function Je(o){H=o,L&&(clearTimeout(L),L=null),console.log("Tilt callback set")}function J(){H=null,L&&(clearTimeout(L),L=null)}function ue(){Q=!1,J(),D&&D.stop()}async function Xe(){try{return(await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}})).getTracks().forEach(n=>n.stop()),!0}catch(o){return console.error("Camera permission denied:",o),!1}}function et(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var X={};(function o(n,r,i,h){var v=!!(n.Worker&&n.Blob&&n.Promise&&n.OffscreenCanvas&&n.OffscreenCanvasRenderingContext2D&&n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype.transferControlToOffscreen&&n.URL&&n.URL.createObjectURL),C=typeof Path2D=="function"&&typeof DOMMatrix=="function",O=function(){if(!n.OffscreenCanvas)return!1;try{var t=new OffscreenCanvas(1,1),e=t.getContext("2d");e.fillRect(0,0,1,1);var a=t.transferToImageBitmap();e.createPattern(a,"no-repeat")}catch{return!1}return!0}();function x(){}function q(t){var e=r.exports.Promise,a=e!==void 0?e:n.Promise;return typeof a=="function"?new a(t):(t(x,x),null)}var V=function(t,e){return{transform:function(a){if(t)return a;if(e.has(a))return e.get(a);var c=new OffscreenCanvas(a.width,a.height),l=c.getContext("2d");return l.drawImage(a,0,0),e.set(a,c),c},clear:function(){e.clear()}}}(O,new Map),W=function(){var t=Math.floor(16.666666666666668),e,a,c={},l=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(u){var d=Math.random();return c[d]=requestAnimationFrame(function s(m){l===m||l+t-1<m?(l=m,delete c[d],u()):c[d]=requestAnimationFrame(s)}),d},a=function(u){c[u]&&cancelAnimationFrame(c[u])}):(e=function(u){return setTimeout(u,t)},a=function(u){return clearTimeout(u)}),{frame:e,cancel:a}}(),fe=function(){var t,e,a={};function c(l){function u(d,s){l.postMessage({options:d||{},callback:s})}l.init=function(s){var m=s.transferControlToOffscreen();l.postMessage({canvas:m},[m])},l.fire=function(s,m,y){if(e)return u(s,null),e;var p=Math.random().toString(36).slice(2);return e=q(function(w){function b(I){I.data.callback===p&&(delete a[p],l.removeEventListener("message",b),e=null,V.clear(),y(),w())}l.addEventListener("message",b),u(s,p),a[p]=b.bind(null,{data:{callback:p}})}),e},l.reset=function(){l.postMessage({reset:!0});for(var s in a)a[s](),delete a[s]}}return function(){if(t)return t;if(!i&&v){var l=["var CONFETTI, SIZE = {}, module = {};","("+o.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{t=new Worker(URL.createObjectURL(new Blob([l])))}catch(u){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("üéä Could not load worker",u),null}c(t)}return t}}(),ye={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function we(t,e){return e?e(t):t}function ve(t){return t!=null}function M(t,e,a){return we(t&&ve(t[e])?t[e]:ye[e],a)}function pe(t){return t<0?0:Math.floor(t)}function be(t,e){return Math.floor(Math.random()*(e-t))+t}function $(t){return parseInt(t,16)}function Ce(t){return t.map(Me)}function Me(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:$(e.substring(0,2)),g:$(e.substring(2,4)),b:$(e.substring(4,6))}}function Ie(t){var e=M(t,"origin",Object);return e.x=M(e,"x",Number),e.y=M(e,"y",Number),e}function Ee(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function qe(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function Te(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}function Be(t,e,a,c,l,u,d,s,m){t.save(),t.translate(e,a),t.rotate(u),t.scale(c,l),t.arc(0,0,1,d,s,m),t.restore()}function xe(t){var e=t.angle*(Math.PI/180),a=t.spread*(Math.PI/180);return{x:t.x,y:t.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:t.startVelocity*.5+Math.random()*t.startVelocity,angle2D:-e+(.5*a-Math.random()*a),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:t.color,shape:t.shape,tick:0,totalTicks:t.ticks,decay:t.decay,drift:t.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:t.gravity*3,ovalScalar:.6,scalar:t.scalar,flat:t.flat}}function ke(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var a=e.tick++/e.totalTicks,c=e.x+e.random*e.tiltCos,l=e.y+e.random*e.tiltSin,u=e.wobbleX+e.random*e.tiltCos,d=e.wobbleY+e.random*e.tiltSin;if(t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-a)+")",t.beginPath(),C&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))t.fill(Ae(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(u-c)*.1,Math.abs(d-l)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var s=Math.PI/10*e.wobble,m=Math.abs(u-c)*.1,y=Math.abs(d-l)*.1,p=e.shape.bitmap.width*e.scalar,w=e.shape.bitmap.height*e.scalar,b=new DOMMatrix([Math.cos(s)*m,Math.sin(s)*m,-Math.sin(s)*y,Math.cos(s)*y,e.x,e.y]);b.multiplySelf(new DOMMatrix(e.shape.matrix));var I=t.createPattern(V.transform(e.shape.bitmap),"no-repeat");I.setTransform(b),t.globalAlpha=1-a,t.fillStyle=I,t.fillRect(e.x-p/2,e.y-w/2,p,w),t.globalAlpha=1}else if(e.shape==="circle")t.ellipse?t.ellipse(e.x,e.y,Math.abs(u-c)*e.ovalScalar,Math.abs(d-l)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):Be(t,e.x,e.y,Math.abs(u-c)*e.ovalScalar,Math.abs(d-l)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var g=Math.PI/2*3,E=4*e.scalar,T=8*e.scalar,B=e.x,A=e.y,P=5,k=Math.PI/P;P--;)B=e.x+Math.cos(g)*T,A=e.y+Math.sin(g)*T,t.lineTo(B,A),g+=k,B=e.x+Math.cos(g)*E,A=e.y+Math.sin(g)*E,t.lineTo(B,A),g+=k;else t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(l)),t.lineTo(Math.floor(u),Math.floor(d)),t.lineTo(Math.floor(c),Math.floor(e.wobbleY));return t.closePath(),t.fill(),e.tick<e.totalTicks}function Fe(t,e,a,c,l){var u=e.slice(),d=t.getContext("2d"),s,m,y=q(function(p){function w(){s=m=null,d.clearRect(0,0,c.width,c.height),V.clear(),l(),p()}function b(){i&&!(c.width===h.width&&c.height===h.height)&&(c.width=t.width=h.width,c.height=t.height=h.height),!c.width&&!c.height&&(a(t),c.width=t.width,c.height=t.height),d.clearRect(0,0,c.width,c.height),u=u.filter(function(I){return ke(d,I)}),u.length?s=W.frame(b):w()}s=W.frame(b),m=w});return{addFettis:function(p){return u=u.concat(p),y},canvas:t,promise:y,reset:function(){s&&W.cancel(s),m&&m()}}}function ee(t,e){var a=!t,c=!!M(e||{},"resize"),l=!1,u=M(e,"disableForReducedMotion",Boolean),d=v&&!!M(e||{},"useWorker"),s=d?fe():null,m=a?Ee:qe,y=t&&s?!!t.__confetti_initialized:!1,p=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,w;function b(g,E,T){for(var B=M(g,"particleCount",pe),A=M(g,"angle",Number),P=M(g,"spread",Number),k=M(g,"startVelocity",Number),Pe=M(g,"decay",Number),De=M(g,"gravity",Number),Oe=M(g,"drift",Number),ne=M(g,"colors",Ce),Re=M(g,"ticks",Number),oe=M(g,"shapes"),Ne=M(g,"scalar"),Qe=!!M(g,"flat"),re=Ie(g),ae=B,z=[],He=t.width*re.x,je=t.height*re.y;ae--;)z.push(xe({x:He,y:je,angle:A,spread:P,startVelocity:k,color:ne[ae%ne.length],shape:oe[be(0,oe.length)],ticks:Re,decay:Pe,gravity:De,drift:Oe,scalar:Ne,flat:Qe}));return w?w.addFettis(z):(w=Fe(t,z,m,E,T),w.promise)}function I(g){var E=u||M(g,"disableForReducedMotion",Boolean),T=M(g,"zIndex",Number);if(E&&p)return q(function(k){k()});a&&w?t=w.canvas:a&&!t&&(t=Te(T),document.body.appendChild(t)),c&&!y&&m(t);var B={width:t.width,height:t.height};s&&!y&&s.init(t),y=!0,s&&(t.__confetti_initialized=!0);function A(){if(s){var k={getBoundingClientRect:function(){if(!a)return t.getBoundingClientRect()}};m(k),s.postMessage({resize:{width:k.width,height:k.height}});return}B.width=B.height=null}function P(){w=null,c&&(l=!1,n.removeEventListener("resize",A)),a&&t&&(document.body.contains(t)&&document.body.removeChild(t),t=null,y=!1)}return c&&!l&&(l=!0,n.addEventListener("resize",A,!1)),s?s.fire(g,B,P):b(g,B,P)}return I.reset=function(){s&&s.reset(),w&&w.reset()},I}var U;function te(){return U||(U=ee(null,{useWorker:!0,resize:!0})),U}function Ae(t,e,a,c,l,u,d){var s=new Path2D(t),m=new Path2D;m.addPath(s,new DOMMatrix(e));var y=new Path2D;return y.addPath(m,new DOMMatrix([Math.cos(d)*l,Math.sin(d)*l,-Math.sin(d)*u,Math.cos(d)*u,a,c])),y}function Le(t){if(!C)throw new Error("path confetti are not supported in this browser");var e,a;typeof t=="string"?e=t:(e=t.path,a=t.matrix);var c=new Path2D(e),l=document.createElement("canvas"),u=l.getContext("2d");if(!a){for(var d=1e3,s=d,m=d,y=0,p=0,w,b,I=0;I<d;I+=2)for(var g=0;g<d;g+=2)u.isPointInPath(c,I,g,"nonzero")&&(s=Math.min(s,I),m=Math.min(m,g),y=Math.max(y,I),p=Math.max(p,g));w=y-s,b=p-m;var E=10,T=Math.min(E/w,E/b);a=[T,0,0,T,-Math.round(w/2+s)*T,-Math.round(b/2+m)*T]}return{type:"path",path:e,matrix:a}}function Se(t){var e,a=1,c="#000000",l='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof t=="string"?e=t:(e=t.text,a="scalar"in t?t.scalar:a,l="fontFamily"in t?t.fontFamily:l,c="color"in t?t.color:c);var u=10*a,d=""+u+"px "+l,s=new OffscreenCanvas(u,u),m=s.getContext("2d");m.font=d;var y=m.measureText(e),p=Math.ceil(y.actualBoundingBoxRight+y.actualBoundingBoxLeft),w=Math.ceil(y.actualBoundingBoxAscent+y.actualBoundingBoxDescent),b=2,I=y.actualBoundingBoxLeft+b,g=y.actualBoundingBoxAscent+b;p+=b+b,w+=b+b,s=new OffscreenCanvas(p,w),m=s.getContext("2d"),m.font=d,m.fillStyle=c,m.fillText(e,I,g);var E=1/a;return{type:"bitmap",bitmap:s.transferToImageBitmap(),matrix:[E,0,0,E,-p*E/2,-w*E/2]}}r.exports=function(){return te().apply(this,arguments)},r.exports.reset=function(){te().reset()},r.exports.create=ee,r.exports.shapeFromPath=Le,r.exports.shapeFromText=Se})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),X,!1);const N=X.exports;X.exports.create;let G=null;function tt(){return G||(G=new(window.AudioContext||window.webkitAudioContext)),G}function de(o){try{const n=tt(),r=n.createOscillator(),i=n.createGain();r.connect(i),i.connect(n.destination),o==="correct"?(r.frequency.setValueAtTime(523.25,n.currentTime),r.frequency.setValueAtTime(659.25,n.currentTime+.1),r.frequency.setValueAtTime(783.99,n.currentTime+.2),i.gain.setValueAtTime(.3,n.currentTime),i.gain.exponentialRampToValueAtTime(.01,n.currentTime+.5),r.start(n.currentTime),r.stop(n.currentTime+.5)):(r.frequency.setValueAtTime(300,n.currentTime),r.frequency.exponentialRampToValueAtTime(150,n.currentTime+.3),i.gain.setValueAtTime(.3,n.currentTime),i.gain.exponentialRampToValueAtTime(.01,n.currentTime+.4),r.start(n.currentTime),r.stop(n.currentTime+.4))}catch(n){console.log("Audio not available:",n)}}function nt(){const n=Date.now()+2e3,r=["#FF6B6B","#4ECDC4","#45B7D1","#96E6A1","#DDA0DD","#FFD93D"];(function i(){N({particleCount:3,angle:60,spread:55,origin:{x:0,y:.7},colors:r}),N({particleCount:3,angle:120,spread:55,origin:{x:1,y:.7},colors:r}),Date.now()<n&&requestAnimationFrame(i)})()}function ot(o){const n=document.getElementById("feedback-overlay"),r=document.getElementById("feedback-icon"),i=document.getElementById("feedback-text");r.textContent="üéâ",i.textContent="Correct!",i.style.color="#4CAF50",n.classList.remove("hidden"),de("correct"),nt(),setTimeout(()=>{n.classList.add("hidden"),o&&o()},1500)}function rt(o){const n=document.getElementById("feedback-overlay"),r=document.getElementById("feedback-icon"),i=document.getElementById("feedback-text");r.textContent="üò¢",i.textContent="Oops! Try again!",i.style.color="#FF6B6B",n.classList.remove("hidden"),de("wrong"),setTimeout(()=>{n.classList.add("hidden"),o&&o()},1200)}function at(o,n){if(o>=n*.8){const i=Date.now()+3e3;(function h(){N({particleCount:5,angle:60,spread:80,origin:{x:0,y:.8},colors:["#FFD700","#FF6B6B","#4ECDC4"]}),N({particleCount:5,angle:120,spread:80,origin:{x:1,y:.8},colors:["#FFD700","#FF6B6B","#4ECDC4"]}),Date.now()<i&&requestAnimationFrame(h)})()}else o>=n*.5&&N({particleCount:80,spread:100,origin:{y:.6}})}const f={currentScreen:"welcome",questions:[],currentQuestionIndex:0,score:0,isAnswering:!1,editingQuestionIndex:null},_={welcome:document.getElementById("welcome-screen"),permission:document.getElementById("permission-screen"),instructions:document.getElementById("instructions-screen"),game:document.getElementById("game-screen"),results:document.getElementById("results-screen"),manager:document.getElementById("manager-screen")};function it(){st(),F("welcome")}function st(){document.getElementById("start-btn").addEventListener("click",ct),document.getElementById("manage-btn").addEventListener("click",()=>F("manager")),document.getElementById("allow-camera-btn").addEventListener("click",lt),document.getElementById("back-to-welcome").addEventListener("click",()=>F("welcome")),document.getElementById("ready-btn").addEventListener("click",ut),document.getElementById("play-again-btn").addEventListener("click",gt),document.getElementById("home-btn").addEventListener("click",ht),document.getElementById("manager-back-btn").addEventListener("click",()=>F("welcome")),document.getElementById("add-question-btn").addEventListener("click",ft),document.getElementById("reset-questions-btn").addEventListener("click",wt),document.getElementById("cancel-modal-btn").addEventListener("click",he),document.getElementById("question-form").addEventListener("submit",yt)}function F(o){Object.keys(_).forEach(n=>{_[n].classList.remove("active")}),_[o].classList.add("active"),f.currentScreen=o,o==="manager"&&j()}async function ct(){if(!et()){alert("Camera is not available on this device. Please use a device with a camera.");return}F("permission")}async function lt(){const o=document.getElementById("allow-camera-btn");o.textContent="Requesting...",o.disabled=!0,await Xe()?(F("instructions"),await me()):(alert("Camera permission was denied. Please allow camera access to play the game."),o.textContent="Allow Camera",o.disabled=!1)}async function me(){const o=document.getElementById("preview-video");try{const n=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"}});o.srcObject=n,await le(o,null)}catch(n){console.error("Failed to initialize camera:",n),alert("Failed to start camera. Please refresh and try again.")}}async function ut(){f.questions=ze(10).map(Ge),f.currentQuestionIndex=0,f.score=0,f.isAnswering=!1,ge(),F("game");const o=document.getElementById("game-video"),n=document.getElementById("face-canvas");try{n.width=640,n.height=480,console.log("Initializing face tracking for game..."),await le(o,n),await new Promise(r=>setTimeout(r,300)),console.log("Setting tilt callback..."),Je(dt),Z(),console.log("Game started, waiting for head tilts...")}catch(r){console.error("Failed to start game:",r),alert("Failed to start camera. Please refresh and try again.")}}function Z(){if(f.currentQuestionIndex>=f.questions.length){mt();return}const o=f.questions[f.currentQuestionIndex];document.getElementById("question-text").textContent=o.text,document.getElementById("answer-left").querySelector(".answer-text").textContent=o.leftAnswer,document.getElementById("answer-right").querySelector(".answer-text").textContent=o.rightAnswer,document.getElementById("current-question").textContent=f.currentQuestionIndex+1,document.getElementById("total-questions").textContent=f.questions.length,document.getElementById("answer-left").className="answer-card answer-left",document.getElementById("answer-right").className="answer-card answer-right",f.isAnswering=!0}function dt(o){if(!f.isAnswering||f.currentScreen!=="game")return;f.isAnswering=!1;const n=f.questions[f.currentQuestionIndex],r=o==="left"?document.getElementById("answer-left"):document.getElementById("answer-right"),i=n.correctSide==="left"?document.getElementById("answer-left"):document.getElementById("answer-right"),h=o===n.correctSide;r.classList.add("highlight"),setTimeout(()=>{h?(f.score++,ge(),i.classList.add("correct"),ot(()=>{f.currentQuestionIndex++,Z()})):(r.classList.add("wrong"),i.classList.add("correct"),rt(()=>{f.currentQuestionIndex++,Z()}))},300)}function ge(){document.getElementById("score").textContent=f.score}function mt(){J(),ue();const o=f.score/f.questions.length*100;let n,r;o>=90?(n="Amazing! üåü",r="You are a vocabulary superstar!"):o>=70?(n="Great Job! üéâ",r="You did really well!"):o>=50?(n="Good Try! üëç",r="Keep practicing and you'll do even better!"):(n="Keep Going! üí™",r="Practice makes perfect!"),document.getElementById("results-title").textContent=n,document.getElementById("final-score").textContent=f.score,document.querySelector(".score-max").textContent=`/ ${f.questions.length}`,document.getElementById("results-message").textContent=r,F("results"),at(f.score,f.questions.length)}async function gt(){F("instructions"),await me()}function ht(){ue(),F("welcome")}function j(){const o=document.getElementById("questions-list"),n=R();if(n.length===0){o.innerHTML='<p style="text-align: center; color: #888;">No questions yet. Add some!</p>';return}o.innerHTML=n.map((r,i)=>`
    <div class="question-item" data-index="${i}">
      <div class="question-info">
        <h4>${r.question}</h4>
        <div class="question-answers">
          <span class="answer-tag correct">‚úì ${r.correct}</span>
          <span class="answer-tag wrong">‚úó ${r.wrong}</span>
        </div>
        <span class="category-tag">${_e[r.category]||r.category}</span>
      </div>
      <div class="question-actions">
        <button class="btn-edit" onclick="editQuestion(${i})">‚úèÔ∏è</button>
        <button class="btn-delete" onclick="deleteQuestionHandler(${i})">üóëÔ∏è</button>
      </div>
    </div>
  `).join("")}function ft(){f.editingQuestionIndex=null,document.getElementById("modal-title").textContent="Add Question",document.getElementById("question-form").reset(),document.getElementById("question-modal").classList.remove("hidden")}window.editQuestion=function(o){const r=R()[o];f.editingQuestionIndex=o,document.getElementById("modal-title").textContent="Edit Question",document.getElementById("question-input").value=r.question,document.getElementById("correct-answer-input").value=r.correct,document.getElementById("wrong-answer-input").value=r.wrong,document.getElementById("category-select").value=r.category,document.getElementById("question-modal").classList.remove("hidden")};window.deleteQuestionHandler=function(o){confirm("Are you sure you want to delete this question?")&&($e(o),j())};function he(){document.getElementById("question-modal").classList.add("hidden"),f.editingQuestionIndex=null}function yt(o){o.preventDefault();const n={question:document.getElementById("question-input").value.trim(),correct:document.getElementById("correct-answer-input").value.trim(),wrong:document.getElementById("wrong-answer-input").value.trim(),category:document.getElementById("category-select").value};f.editingQuestionIndex!==null?We(f.editingQuestionIndex,n):Ve(n),he(),j()}function wt(){confirm("Reset all questions to default? This will remove any custom questions.")&&(Ue(),j())}document.addEventListener("DOMContentLoaded",it);
