<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Head Tilt Vocabulary Game</title>
    <meta name="description" content="Interactive vocabulary learning game for kids using head movements">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles.css">
</head>

<body>
    <div id="app">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <div class="welcome-content">
                <h1 class="game-title">üéÆ Vocabulary Quest</h1>
                <p class="game-subtitle">Learn English with Head Movements!</p>
                <div class="mascot">ü¶ä</div>

                <div class="game-options">
                    <label class="toggle-option">
                        <input type="checkbox" id="shuffle-toggle" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">üîÄ Shuffle Questions</span>
                    </label>
                    
                    <div class="question-limit-option">
                        <label for="question-limit">üìä Number of Questions:</label>
                        <div class="limit-input-group">
                            <input type="number" id="question-limit" min="1" placeholder="All">
                            <span class="limit-hint">(Leave empty for all questions)</span>
                        </div>
                    </div>

                    <div class="unit-select-option">
                        <label>üß© Choose Unit(s):</label>
                        <div id="unit-checkboxes" class="unit-checkboxes"></div>
                    </div>
                </div>

                <button id="start-btn" class="btn btn-primary btn-large">
                    <span>‚ñ∂Ô∏è</span> Start Game
                </button>
                <button id="manage-btn" class="btn btn-secondary">
                    <span>‚öôÔ∏è</span> Manage Questions
                </button>
            </div>
        </div>

        <!-- Permission Screen -->
        <div id="permission-screen" class="screen">
            <div class="permission-content">
                <div class="camera-icon">üì∑</div>
                <h2>Camera Permission Needed</h2>
                <p>This game uses your camera to detect head tilts.<br>No images are saved!</p>
                <button id="allow-camera-btn" class="btn btn-primary btn-large">
                    Allow Camera
                </button>
                <button id="back-to-welcome" class="btn btn-secondary">
                    ‚Üê Back
                </button>
            </div>
        </div>

        <!-- Instructions Screen -->
        <div id="instructions-screen" class="screen">
            <div class="instructions-content">
                <h2>How to Play</h2>
                <div class="instruction-cards">
                    <div class="instruction-card">
                        <div class="instruction-icon">‚¨ÖÔ∏è</div>
                        <p>Tilt head <strong>LEFT</strong> to choose left answer</p>
                    </div>
                    <div class="instruction-card">
                        <div class="instruction-icon">‚û°Ô∏è</div>
                        <p>Tilt head <strong>RIGHT</strong> to choose right answer</p>
                    </div>
                </div>
                <div class="camera-preview-container">
                    <video id="preview-video" autoplay playsinline></video>
                    <div id="tilt-indicator" class="tilt-indicator">Keep your head straight</div>
                </div>
                <button id="ready-btn" class="btn btn-primary btn-large">
                    I'm Ready! üöÄ
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="score-display">
                    <span class="score-label">Score:</span>
                    <span id="score">0</span>
                </div>
                <div class="progress-display">
                    <span id="current-question">1</span> / <span id="total-questions">10</span>
                </div>
                <button id="end-game-btn" class="btn btn-end-game">‚èπÔ∏è End</button>
            </div>

            <div class="question-container">
                <h2 id="question-text" class="question-text">Loading question...</h2>
            </div>

            <div class="answers-container">
                <div id="answer-left" class="answer-card answer-left">
                    <span class="answer-text">Left Answer</span>
                </div>
                <div class="camera-feed-container">
                    <video id="game-video" autoplay playsinline></video>
                    <canvas id="face-canvas"></canvas>
                    <div id="direction-arrow" class="direction-arrow"></div>
                </div>
                <div id="answer-right" class="answer-card answer-right">
                    <span class="answer-text">Right Answer</span>
                </div>
            </div>

            <div id="feedback-overlay" class="feedback-overlay hidden">
                <div class="feedback-content">
                    <div id="feedback-icon" class="feedback-icon"></div>
                    <div id="feedback-text" class="feedback-text"></div>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="results-content">
                <h2 id="results-title">Great Job! üéâ</h2>
                <div class="score-circle">
                    <span id="final-score">0</span>
                    <span class="score-max">/ 10</span>
                </div>
                <p id="results-message">You did amazing!</p>
                <div class="results-buttons">
                    <button id="play-again-btn" class="btn btn-primary btn-large">
                        üîÑ Play Again
                    </button>
                </div>
            </div>
        </div>

        <!-- Question Manager Screen -->
        <div id="manager-screen" class="screen">
            <div class="manager-content">
                <div class="manager-header">
                    <h2>üìù Question Manager</h2>
                    <div class="manager-header-buttons">
                        <button id="manager-start-btn" class="btn btn-primary">‚ñ∂Ô∏è Start Game</button>
                        <button id="manager-back-btn" class="btn btn-icon">‚Üê Back</button>
                    </div>
                </div>

                <div class="manager-controls">
                    <button id="add-question-btn" class="btn btn-primary">
                        ‚ûï Add Question
                    </button>
                    <button id="reset-questions-btn" class="btn btn-secondary">
                        üîÑ Reset to Default
                    </button>
                </div>

                <div class="unit-manager">
                    <div class="unit-manager-header">
                        <h3>üìö Units</h3>
                        <div class="unit-actions">
                            <button id="add-unit-btn" class="btn btn-primary btn-small">‚ûï Add Unit</button>
                            <button id="rename-unit-btn" class="btn btn-secondary btn-small">‚úèÔ∏è Rename</button>
                            <button id="delete-unit-btn" class="btn btn-danger btn-small">üóëÔ∏è Delete</button>
                        </div>
                    </div>
                    <div id="unit-tabs" class="unit-tabs"></div>
                </div>

                <div id="questions-list" class="questions-list">
                    <!-- Questions will be rendered here -->
                </div>
            </div>

            <!-- Add/Edit Question Modal -->
            <div id="question-modal" class="modal hidden">
                <div class="modal-content">
                    <h3 id="modal-title">Add Question</h3>
                    <form id="question-form">
                        <div class="form-group">
                            <label for="question-input">Question (Vietnamese):</label>
                            <input type="text" id="question-input" placeholder="H√†nh ƒë·ªông n√†o l√† b∆°i?" required>
                        </div>
                        <div class="form-group">
                            <label for="correct-answer-input">Correct Answer (English):</label>
                            <input type="text" id="correct-answer-input" placeholder="swim" required>
                        </div>
                        <div class="form-group">
                            <label for="wrong-answer-input">Wrong Answer (English):</label>
                            <input type="text" id="wrong-answer-input" placeholder="run" required>
                        </div>
                        <div class="form-group">
                            <label for="question-unit-select">Unit:</label>
                            <select id="question-unit-select" required></select>
                        </div>
                        <div class="modal-buttons">
                            <button type="submit" class="btn btn-primary">Save</button>
                            <button type="button" id="cancel-modal-btn" class="btn btn-secondary">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Add/Rename Unit Modal -->
            <div id="unit-modal" class="modal hidden">
                <div class="modal-content">
                    <h3 id="unit-modal-title">Add Unit</h3>
                    <form id="unit-form">
                        <div class="form-group">
                            <label for="unit-name-input">Unit Name:</label>
                            <input type="text" id="unit-name-input" placeholder="Unit name" required>
                        </div>
                        <div class="modal-buttons">
                            <button type="submit" class="btn btn-primary">Save</button>
                            <button type="button" id="cancel-unit-modal-btn" class="btn btn-secondary">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Confirm Delete Unit Modal -->
            <div id="confirm-delete-unit-modal" class="modal hidden">
                <div class="modal-content confirm-modal">
                    <div class="confirm-icon">‚ö†Ô∏è</div>
                    <h3>Delete Unit?</h3>
                    <p>This will remove the unit <strong id="delete-unit-name"></strong> and all its questions.</p>
                    <div class="modal-buttons">
                        <button type="button" id="confirm-delete-unit-btn" class="btn btn-danger">Delete</button>
                        <button type="button" id="cancel-delete-unit-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Confirm Reset Modal -->
            <div id="confirm-reset-modal" class="modal hidden">
                <div class="modal-content confirm-modal">
                    <div class="confirm-icon">‚ö†Ô∏è</div>
                    <h3>Reset to Default?</h3>
                    <p>This will remove all custom questions and restore the original question set.</p>
                    <div class="modal-buttons">
                        <button type="button" id="confirm-reset-btn" class="btn btn-danger">Reset</button>
                        <button type="button" id="cancel-reset-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Authentication Modal -->
        <div id="auth-modal" class="modal hidden">
            <div class="modal-content">
                <h3>üîí Authentication Required</h3>
                <p class="auth-description">Please enter the password to manage questions</p>
                <form id="auth-form">
                    <div class="form-group">
                        <label for="password-input">Password:</label>
                        <input type="password" id="password-input" placeholder="Enter password" required autocomplete="off">
                        <div id="auth-error" class="auth-error hidden">Incorrect password</div>
                    </div>
                    <div class="modal-buttons">
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="button" id="cancel-auth-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MediaPipe dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script>

    <script type="module" src="/src/main.js"></script>
</body>

</html>